<!-- DEMO SECTION -->
<section id="demo" class="py-5 bg-light text-center">
  <div class="container">
    <h2 class="fw-bold mb-3 text-gradient">Prueba la magia de ImageEnhance AI</h2>
    <p class="text-muted mb-5">Sube una imagen, deja que la IA haga su trabajo y obtÃ©n un PDF de alta calidad en segundos.</p>

    <!-- Upload Box -->
    <div id="drop-area" class="border border-2 border-dashed p-5 rounded-4 bg-white shadow-sm mx-auto" style="max-width: 600px; cursor: pointer;">
      <input type="file" id="fileElem" accept="image/*" style="display:none">
      <p id="drop-text" class="mb-0 text-muted">
        ğŸ“ Arrastra una imagen aquÃ­ o <span class="text-primary fw-semibold">haz clic para seleccionar</span>
      </p>
    </div>

    <!-- Preview -->
    <div id="preview-container" class="mt-4 d-none">
      <img id="preview" src="" alt="preview" class="img-fluid rounded shadow-sm" style="max-height:300px;"/>
      <div class="mt-4">
        <button id="enhanceBtn" class="btn btn-custom px-4 py-2">Mejorar Calidad</button>
      </div>
    </div>

    <!-- Loading -->
    <div id="loading" class="mt-4 d-none">
      <div class="spinner-border text-warning" role="status"></div>
      <p class="mt-3 fw-semibold text-secondary">Procesando con IA...</p>
    </div>

    <!-- Download -->
    <div id="result" class="mt-4 d-none">
      <p class="fw-semibold text-success mb-3">âœ… Â¡Listo! Tu imagen mejorada estÃ¡ lista.</p>
      <a href="#" id="downloadLink" class="btn btn-outline-success">Descargar PDF</a>
    </div>
  </div>
</section>

<script>
  const dropArea = document.getElementById("drop-area");
  const fileElem = document.getElementById("fileElem");
  const previewContainer = document.getElementById("preview-container");
  const previewImg = document.getElementById("preview");
  const loading = document.getElementById("loading");
  const result = document.getElementById("result");
  const enhanceBtn = document.getElementById("enhanceBtn");
  const downloadLink = document.getElementById("downloadLink");

  // Abrir selector de archivos
  dropArea.addEventListener("click", () => fileElem.click());

  // Manejo de drop
  dropArea.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropArea.classList.add("bg-warning-subtle");
  });
  dropArea.addEventListener("dragleave", () => dropArea.classList.remove("bg-warning-subtle"));

  dropArea.addEventListener("drop", (e) => {
    e.preventDefault();
    dropArea.classList.remove("bg-warning-subtle");
    const file = e.dataTransfer.files[0];
    handleFile(file);
  });

  fileElem.addEventListener("change", (e) => {
    const file = e.target.files[0];
    handleFile(file);
  });

  function handleFile(file) {
    if (!file || !file.type.startsWith("image/")) return alert("Por favor selecciona una imagen vÃ¡lida");
    const reader = new FileReader();
    reader.onload = (e) => {
      previewImg.src = e.target.result;
      previewContainer.classList.remove("d-none");
    };
    reader.readAsDataURL(file);
  }

  // Simular mejora de calidad
  enhanceBtn.addEventListener("click", () => {
    loading.classList.remove("d-none");
    previewContainer.classList.add("d-none");

    // Simula el proceso (3s)
    setTimeout(() => {
      loading.classList.add("d-none");
      result.classList.remove("d-none");
      downloadLink.href = "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf";
      downloadLink.download = "imagen-mejorada.pdf";
    }, 3000);
  });
</script>
